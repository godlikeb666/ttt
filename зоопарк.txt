USE mydb;

CREATE TABLE species (
    species_id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    daily_feed DECIMAL(10,2),
    family VARCHAR(100),
    continent VARCHAR(100)
);

CREATE TABLE rooms (
    room_id INT AUTO_INCREMENT PRIMARY KEY,
    complex_name VARCHAR(100),
    room_number INT,
    has_pond BOOLEAN,
    has_heating BOOLEAN
);

CREATE TABLE placements (
    placement_id INT AUTO_INCREMENT PRIMARY KEY,
    species_id INT,
    room_id INT,
    animal_count INT,
    birth_events INT DEFAULT 0,
    FOREIGN KEY (species_id) REFERENCES species(species_id),
    FOREIGN KEY (room_id) REFERENCES rooms(room_id)
);

INSERT INTO species (name, daily_feed, family, continent) VALUES 
('Шимпанзе', 2.50, 'Гоминиды', 'Африка'),
('Карликовый гиппопотам', 15.00, 'Бегемотовые', 'Африка'),
('Волк', 3.00, 'Псовые', 'Евразия'),
('Лисица', 1.50, 'Псовые', 'Евразия'),
('Тигр', 8.00, 'Кошачьи', 'Азия');

INSERT INTO rooms (complex_name, room_number, has_pond, has_heating) VALUES 
('Приматы', 101, 0, 1),
('Африка', 102, 0, 1), 
('Лес', 103, 1, 0),
('Тропики', 104, 1, 1);

INSERT INTO placements (species_id, room_id, animal_count, birth_events) VALUES 
(1, 1, 4, 0), 
(2, 2, 2, 1), 
(3, 3, 5, 2), 
(4, 3, 3, 0), 
(5, 4, 2, 0);
Выборки: 
•	Определить суточное потребление корма обитателями комплекса «приматы». 
SELECT SUM(s.daily_feed * p.animal_count) AS total_daily_feed
FROM species s, rooms r, placements p
WHERE s.species_id = p.species_id AND r.room_id = p.room_id
  AND r.complex_name = 'Приматы';
•	Выбрать случаи размножения животного вида «карликовый гиппопотам» в помещении без водоема. 
SELECT s.name, r.room_number, r.complex_name
FROM species s, rooms r, placements p
WHERE s.species_id = p.species_id AND r.room_id = p.room_id
  AND s.name = 'Карликовый гиппопотам'
  AND r.has_pond = 0
  AND p.birth_events > 0;
•	Определить общую численность представителей семейства «псовые» в зоопарке.
 SELECT SUM(p.animal_count)
FROM species s, placements p
WHERE s.species_id = p.species_id
  AND s.family = 'Псовые';
•	Вывести все пары видов, которые содержатся в одном помещении
SELECT s1.name AS species_1, s2.name AS species_2, r.room_number
FROM placements p1
JOIN placements p2 ON p1.room_id = p2.room_id AND p1.species_id < p2.species_id
JOIN species s1 ON p1.species_id = s1.species_id
JOIN species s2 ON p2.species_id = s2.species_id
JOIN rooms r ON p1.room_id = r.room_id;
